<html>
<head>
<title>Sample of watchPosition 2</title>
<script>

let count = 0;
let wwid = null;
let wid = null;

const success = (position) => {
    const coords = position.coords;
    document.getElementById('count').innerHTML = count++;
    document.getElementById('lat').innerHTML = coords.latitude;
    document.getElementById('lnd').innerHTML = coords.longitude;
}
const error = () => {
    const error = document.getElementById("error");
    const div = document.createElement("div"); 
    div.textContent = count;
    error.insertBefore(div, error.querySelector("div"));
}

function stopValidate()
{
    if (wwid) {
        clearTimeout(wwid);
        wwid = null;
    }
    if (wid) {
        geolocation.clearWatch(wid);
        wid = null;
    }
}

function startValidate(timeout)
{
    stopValidate();
    timeout = timeout || 5000;
    //disableAditItem();
    //areaInfo(Measuring, message_measuring);
    wid = geolocation.watchPosition(
        success,
        error,
        {
            enableHighAccuracy: false,
            timeout: timeout,
            maximumAge: 0
        }
    );
    wwid = setTimeout(startValidate, 25000);


    /*
    navigator.geolocation.watchPosition(
        success,
        error,
        {
            enableHighAccuracy: false,
            timeout: 5000,
            maximumAge: 0
        }
    );
    */


}


document.addEventListener("DOMContentLoaded", () => {
    startValidate();
});
</script>
</head>
<body>
<div>
  count: <span id="count"></span>
</div>
<div>
  lat: <span id="lat"></span>
</div>
<div id="lng">
  lnd: <span id="lnd"></span>
</div>
<hr>
<div id="error">
</div>
</body>
</html>
